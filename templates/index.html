{% extends "base.html" %}

{% block title %}Home - Fin Finder AI{% endblock %}

{% block content %}
<!-- Hero Section with Large Logo - REDUCED HEIGHT -->
<div class="relative overflow-hidden bg-gradient-to-r from-blue-900 to-cyan-700 shadow-2xl rounded-lg mb-10">
    <!-- Background Image -->
    <img src="{{ url_for('static', filename='surfer_arm_drag.jpg') }}" 
         alt="Surfer in action" 
         class="absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-60">
    
         <div class="relative z-10 px-4 py-4 sm:px-6 sm:py-8 lg:py-12 lg:px-8 flex flex-col items-center justify-center text-center">        <img src="{{ url_for('static', filename='fin_finder_logo_transparent.png') }}" 
             alt="Fin Finder Logo" 
             class="h-64 md:h-80 w-auto mb-6">
        
        <h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl mb-4">
            Unlock Your Surf Potential
        </h1>
        
        <p class="max-w-lg mx-auto text-xl text-cyan-100 sm:max-w-xl mb-6">
            Stop guessing. Start ripping. Get personalized surfboard fin recommendations from our AI expert.
        </p>
        
        <a href="#ai-chat" 
           class="inline-flex items-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 shadow-lg transition-all duration-300 transform hover:scale-105">
            Your Personal AI Fin Expert is Here
        </a>
    </div>
</div>

<!-- AI Chat Interface -->
<div id="ai-chat" class="max-w-4xl mx-auto mb-16 bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden">
    <div class="bg-gradient-to-r from-blue-600 to-cyan-500 p-4">
        <h2 class="text-2xl font-bold text-white flex items-center">
            <i class="fas fa-comments mr-2"></i> Chat with Your AI Fin Expert
        </h2>
        <p class="text-blue-100">Ask any question about surfboard fins and get expert advice instantly</p>
    </div>
    
    <div class="p-6">
        <!-- Example Messages -->
        <div class="mb-6 space-y-4">
            <div class="flex items-start">
                <div class="flex-shrink-0 mr-3">
                    <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-md">
                    <p class="text-gray-800 dark:text-gray-200">What fins should I use for my 6'2" shortboard in small waves?</p>
                </div>
            </div>
            
            <div class="flex items-start flex-row-reverse">
                <div class="flex-shrink-0 ml-3">
                    <div class="w-10 h-10 rounded-full bg-cyan-600 flex items-center justify-center text-white">
                        <i class="fas fa-robot"></i>
                    </div>
                </div>
                <div class="bg-cyan-50 dark:bg-cyan-900 rounded-lg p-3 max-w-md">
                    <p class="text-gray-800 dark:text-gray-200">For a 6'2" shortboard in small waves, I'd recommend a quad fin setup with smaller fins that have a flatter foil. This will give you more speed and drive in weaker conditions. Look for fins with around 4.0-4.25" depth and a relatively flat inside foil to help generate speed.</p>
                </div>
            </div>
        </div>
        
        <!-- Chat Input -->
        <form id="chat-form" class="flex items-center space-x-3">
            <input type="text" id="question-input" 
                   class="flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 dark:bg-gray-700 dark:text-white" 
                   placeholder="Ask about fins, setups, or recommendations...">
            <button type="submit" 
                    class="px-4 py-3 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg transition-colors duration-300">
                <i class="fas fa-paper-plane mr-2"></i> Ask
            </button>
        </form>
        
        <!-- Response Area -->
        <div id="response-area" class="mt-6 hidden">
            <div class="flex items-start">
                <div class="flex-shrink-0 mr-3">
                    <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-3 max-w-md">
                    <p id="user-question" class="text-gray-800 dark:text-gray-200"></p>
                </div>
            </div>
            
            <div class="flex items-start flex-row-reverse mt-4">
                <div class="flex-shrink-0 ml-3">
                    <div class="w-10 h-10 rounded-full bg-cyan-600 flex items-center justify-center text-white">
                        <i class="fas fa-robot"></i>
                    </div>
                </div>
                <div id="ai-response-container" class="bg-cyan-50 dark:bg-cyan-900 rounded-lg p-3 max-w-md">
                    <p id="ai-response" class="text-gray-800 dark:text-gray-200"></p>
                    <div id="ai-loading" class="flex space-x-1 justify-center py-2">
                        <div class="w-2 h-2 bg-cyan-600 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-cyan-600 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-cyan-600 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Resource Links -->
<div class="bg-gray-50 dark:bg-gray-900 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-bold text-center text-gray-900 dark:text-gray-100 mb-8">
            Explore Our Fin Resources
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <a href="{{ url_for('fundamentals') }}" class="group">
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg transition-all duration-300 transform group-hover:scale-105">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors duration-300">
                            <i class="fas fa-book mr-2"></i> Fin Fundamentals
                        </h3>
                        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                            Learn the basics of fin design, terminology, and how fins affect your surfing.
                        </p>
                    </div>
                </div>
            </a>
            
            <a href="{{ url_for('setups') }}" class="group">
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg transition-all duration-300 transform group-hover:scale-105">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors duration-300">
                            <i class="fas fa-th mr-2"></i> Fin Setups
                        </h3>
                        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                            Compare single, twin, thruster, quad, and other fin configurations.
                        </p>
                    </div>
                </div>
            </a>
            
            <a href="{{ url_for('longboards') }}" class="group">
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg transition-all duration-300 transform group-hover:scale-105">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors duration-300">
                            <i class="fas fa-ruler-horizontal mr-2"></i> Longboard Fins
                        </h3>
                        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                            Specialized guide to longboard fin options, from traditional to performance.
                        </p>
                    </div>
                </div>
            </a>
            
            <a href="{{ url_for('recommender_page') }}" class="group">
                <div class="bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg transition-all duration-300 transform group-hover:scale-105">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors duration-300">
                            <i class="fas fa-magic mr-2"></i> Full Recommender
                        </h3>
                        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                            Get a complete personalized fin recommendation based on your specific needs.
                        </p>
                    </div>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- JavaScript for AI Chat -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const chatForm = document.getElementById('chat-form');
    const questionInput = document.getElementById('question-input');
    const responseArea = document.getElementById('response-area');
    const userQuestion = document.getElementById('user-question');
    const aiResponse = document.getElementById('ai-response');
    const aiLoading = document.getElementById('ai-loading');
    
    // Initially hide the loading indicator
    aiLoading.style.display = 'none';
    
    chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const question = questionInput.value.trim();
        if (!question) return;
        
        // Display user question
        userQuestion.textContent = question;
        responseArea.classList.remove('hidden');
        
        // Show loading indicator, hide previous response
        aiResponse.textContent = '';
        aiLoading.style.display = 'flex';
        
        // Send request to backend
        fetch('/ask', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ question: question }),
        })
        .then(response => response.json())
        .then(data => {
            // Hide loading indicator
            aiLoading.style.display = 'none';
            
            // Display AI response
            if (data.answer) {
                aiResponse.textContent = data.answer;
            } else if (data.error) {
                aiResponse.textContent = `Error: ${data.error}`;
            } else {
                aiResponse.textContent = 'Sorry, I couldn\'t process your question. Please try again.';
            }
        })
        .catch(error => {
            aiLoading.style.display = 'none';
            aiResponse.textContent = 'Sorry, there was a problem connecting to the AI. Please try again later.';
            console.error('Error:', error);
        });
        
        // Clear input
        questionInput.value = '';
    });
});
</script>
{% endblock %}
